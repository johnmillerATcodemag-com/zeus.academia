import{d as q,r as w,c as u,a as J,o as K,e as p,g as e,x as E,t as m,z as v,A as k,B as C,h as X,s as Y,p as S,F,y as ee,i as _}from"./vendor-CycBcXxj.js";import{A as f,u as se}from"./index-B4Vq0GNY.js";import{_ as te}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ui-di-GGlkx.js";const ae=q("data",()=>{const r=w({data:[],totalCount:0,filters:{},pagination:{page:1,pageSize:50,totalPages:0,totalItems:0},loading:!1,error:null}),i=w({data:[],totalCount:0,byDepartment:{},loading:!1,error:null}),n=w({current:[],historical:[],statistics:{},loading:!1,error:null}),c=w({performance:{},health:{},alerts:[],lastUpdated:null,loading:!1,error:null}),y=w({data:[],loading:!1,error:null}),b=w({data:[],loading:!1,error:null}),h=w([]),A=w([]),D=u(()=>!r.value.filters||Object.keys(r.value.filters).length===0?r.value.data:r.value.data.filter(s=>Object.entries(r.value.filters).every(([a,l])=>{if(!l)return!0;const o=s[a];return typeof l=="string"?o==null?void 0:o.toString().toLowerCase().includes(l.toLowerCase()):o===l}))),U=u(()=>{const s={};return i.value.data.forEach(a=>{const l=a.department||"Other";s[l]||(s[l]=[]),s[l].push(a)}),s}),j=u(()=>{const s={totalCurrent:n.value.current.length,totalHistorical:n.value.historical.length,byStatus:{},bySemester:{}};return n.value.current.forEach(a=>{s.byStatus[a.status]=(s.byStatus[a.status]||0)+1,s.bySemester[a.semester]=(s.bySemester[a.semester]||0)+1}),s}),d=u(()=>{const s=c.value.health;if(!s||Object.keys(s).length===0)return"unknown";const a=c.value.alerts.filter(o=>o.severity==="critical").length,l=c.value.alerts.filter(o=>o.severity==="high").length;return a>0?"critical":l>0?"warning":s.overallStatus==="healthy"?"healthy":"warning"}),t=async(s,a)=>{r.value.loading=!0,r.value.error=null;try{s&&(r.value.filters={...s}),a&&(r.value.pagination={...r.value.pagination,...a});const l=await f.users.getAll(r.value.filters,r.value.pagination);if(l.success&&l.data)r.value.data=l.data.data,r.value.totalCount=l.data.total,r.value.pagination.totalItems=l.data.total,r.value.pagination.totalPages=Math.ceil(l.data.total/r.value.pagination.pageSize);else throw new Error(l.message||"Failed to load users")}catch(l){r.value.error=l.message,console.error("Error loading users:",l)}finally{r.value.loading=!1}},x=async s=>{try{const a=await f.users.create(s);if(a.success&&a.data)return await t(),{success:!0,data:a.data};throw new Error(a.message||"Failed to create user")}catch(a){return{success:!1,error:a.message}}},N=async(s,a)=>{try{const l=await f.users.update(s,a);if(l.success&&l.data){const o=r.value.data.findIndex(g=>g.id===s);return o!==-1&&(r.value.data[o]={...r.value.data[o],...l.data}),{success:!0,data:l.data}}else throw new Error(l.message||"Failed to update user")}catch(l){return{success:!1,error:l.message}}},O=async s=>{try{const a=await f.users.delete(s);if(a.success)return r.value.data=r.value.data.filter(l=>l.id!==s),r.value.totalCount-=1,{success:!0};throw new Error(a.message||"Failed to delete user")}catch(a){return{success:!1,error:a.message}}},R=async(s,a,l)=>{try{const o=await f.users.bulkOperation(s,a,l);if(o.success&&o.data)return await t(),o.data;throw new Error(o.message||"Bulk operation failed")}catch(o){return{success:0,failed:a.length,errors:[o.message],details:{successIds:[],failedIds:a,warnings:[]}}}},B=async s=>{i.value.loading=!0,i.value.error=null;try{const a=s?{departmentId:s}:void 0,l=await f.academic.getCourses(a);if(l.success&&l.data)i.value.data=l.data.data,i.value.totalCount=l.data.total,i.value.byDepartment={},l.data.data.forEach(o=>{const g=o.department||"Other";i.value.byDepartment[g]||(i.value.byDepartment[g]=[]),i.value.byDepartment[g].push(o)});else throw new Error(l.message||"Failed to load courses")}catch(a){i.value.error=a.message,console.error("Error loading courses:",a)}finally{i.value.loading=!1}},M=async s=>{n.value.loading=!0,n.value.error=null;try{const a=s?{semesterId:s}:void 0,l=await f.academic.getEnrollments(a);if(l.success&&l.data){n.value.current=l.data.data;const o={total:l.data.data.length,byStatus:{},bySemester:{},byDepartment:{}};l.data.data.forEach(g=>{o.byStatus[g.status]=(o.byStatus[g.status]||0)+1,o.bySemester[g.semester]=(o.bySemester[g.semester]||0)+1,o.byDepartment[g.department]=(o.byDepartment[g.department]||0)+1}),n.value.statistics=o}else throw new Error(l.message||"Failed to load enrollment data")}catch(a){n.value.error=a.message,console.error("Error loading enrollment data:",a)}finally{n.value.loading=!1}},H=async s=>{try{const a=await f.academic.bulkEnrollment(s);if(a.success&&a.data)return await M(),a.data;throw new Error(a.message||"Bulk enrollment operation failed")}catch{return{success:0,failed:s.length}}},z=async()=>{c.value.loading=!0,c.value.error=null;try{const[s,a]=await Promise.all([f.system.getHealth(),f.system.getMetrics()]);s.success&&s.data&&(c.value.health=s.data),a.success&&a.data&&(c.value.performance=a.data),c.value.alerts=[{id:"1",type:"warning",title:"High Memory Usage",message:"System memory usage is at 85%",timestamp:new Date,severity:"medium",category:"system",acknowledged:!1}],c.value.lastUpdated=new Date}catch(s){c.value.error=s.message,console.error("Error refreshing system metrics:",s)}finally{c.value.loading=!1}},I=async()=>{y.value.loading=!0,y.value.error=null;try{const s=await f.academic.getDepartments();if(s.success&&s.data)y.value.data=s.data;else throw new Error(s.message||"Failed to load departments")}catch(s){y.value.error=s.message,console.error("Error loading departments:",s)}finally{y.value.loading=!1}},V=async()=>{b.value.loading=!0,b.value.error=null;try{const s=await f.roles.getAll();if(s.success&&s.data)b.value.data=s.data;else throw new Error(s.message||"Failed to load roles")}catch(s){b.value.error=s.message,console.error("Error loading roles:",s)}finally{b.value.loading=!1}},T=s=>{h.value.includes(s)||h.value.push(s)},W=s=>{h.value=h.value.filter(a=>a!==s)},$=()=>{h.value=r.value.data.map(s=>s.id)},G=()=>{h.value=[]},Q=s=>h.value.includes(s),L=()=>{r.value.data=[],r.value.totalCount=0,r.value.filters={},r.value.pagination={page:1,pageSize:50,totalPages:0,totalItems:0},h.value=[]},P=()=>{i.value.data=[],i.value.totalCount=0,i.value.byDepartment={}},Z=()=>{L(),P(),n.value={current:[],historical:[],statistics:{},loading:!1,error:null},c.value={performance:{},health:{},alerts:[],lastUpdated:null,loading:!1,error:null},A.value=[]};return{users:u(()=>r.value),courses:u(()=>i.value),enrollments:u(()=>n.value),systemMetrics:u(()=>c.value),departments:u(()=>y.value),roles:u(()=>b.value),selectedUsers:u(()=>h.value),selectedEnrollments:u(()=>A.value),filteredUsers:D,coursesByDepartment:U,enrollmentStatistics:j,systemHealthStatus:d,loadUsers:t,createUser:x,updateUser:N,deleteUser:O,bulkUserOperation:R,loadCourses:B,loadEnrollmentData:M,bulkEnrollmentOperation:H,refreshSystemMetrics:z,loadDepartments:I,loadRoles:V,selectUser:T,deselectUser:W,selectAllUsers:$,deselectAllUsers:G,isUserSelected:Q,clearUsersData:L,clearCoursesData:P,clearAllData:Z}}),le={class:"dashboard-layout"},re={class:"navbar navbar-expand-lg navbar-dark bg-zeus-primary"},oe={class:"container-fluid"},ne={class:"navbar-nav ms-auto"},ie={class:"nav-item dropdown"},ce={class:"nav-link dropdown-toggle d-flex align-items-center",href:"#",role:"button","data-bs-toggle":"dropdown"},de={class:"user-avatar me-2"},ue={class:"dropdown-menu dropdown-menu-end"},me={class:"container-fluid mt-4"},ve={class:"row mb-4"},ge={class:"col-12"},fe={class:"card"},be={class:"card-body"},he={class:"card-title mb-3"},ye={class:"card-text text-muted"},pe={class:"badge bg-primary"},_e={class:"small text-muted"},we={class:"row"},xe={class:"col-lg-3 col-md-6 mb-4"},Se={class:"card text-white bg-primary"},ke={class:"card-body"},Ce={class:"d-flex justify-content-between"},Ee={class:"mb-0"},Ae={class:"col-lg-3 col-md-6 mb-4"},De={class:"card text-white bg-success"},Ue={class:"card-body"},je={class:"d-flex justify-content-between"},Fe={class:"mb-0"},Me={class:"col-lg-3 col-md-6 mb-4"},Le={class:"card text-white bg-warning"},Pe={class:"card-body"},Ne={class:"d-flex justify-content-between"},Oe={class:"mb-0"},Re={class:"col-lg-3 col-md-6 mb-4"},Be={class:"card text-white bg-danger"},He={class:"card-body"},ze={class:"d-flex justify-content-between"},Ie={class:"mb-0"},Ve={class:"col-lg-3 col-md-6 mb-4"},Te={class:"card text-white bg-info"},We={class:"card-body"},$e={class:"d-flex justify-content-between"},Ge={class:"mb-0"},Qe={class:"col-lg-3 col-md-6 mb-4"},Ze={class:"card text-white bg-success"},qe={class:"card-body"},Je={class:"d-flex justify-content-between"},Ke={class:"mb-0"},Xe={class:"col-lg-3 col-md-6 mb-4"},Ye={class:"card text-white bg-primary"},es={class:"card-body"},ss={class:"d-flex justify-content-between"},ts={class:"mb-0"},as={class:"col-lg-3 col-md-6 mb-4"},ls={class:"card text-white bg-info"},rs={class:"card-body"},os={class:"d-flex justify-content-between"},ns={class:"mb-0"},is={class:"row"},cs={class:"col-12"},ds={class:"card"},us={class:"card-body"},ms={class:"row"},vs={key:0,class:"col-lg-2 col-md-4 col-sm-6 mb-3"},gs={key:1,class:"col-lg-2 col-md-4 col-sm-6 mb-3"},fs={key:2,class:"col-lg-2 col-md-4 col-sm-6 mb-3"},bs={key:3,class:"col-lg-2 col-md-4 col-sm-6 mb-3"},hs={key:4,class:"col-lg-2 col-md-4 col-sm-6 mb-3"},ys={key:5,class:"col-lg-2 col-md-4 col-sm-6 mb-3"},ps=J({__name:"DashboardView",setup(r){const i=ee(),n=se(),c=ae(),y=w({totalUsers:1250,activeSessions:42,criticalAlerts:2}),b=w({totalEnrollments:3450,activeCourses:120,facultyCount:85,departmentCount:12}),h=u(()=>{const d=n.user;return d?`${d.firstName.charAt(0)}${d.lastName.charAt(0)}`.toUpperCase():"?"}),A=u(()=>({system_admin:"System Administrator",registrar:"Registrar",academic_admin:"Academic Administrator"})[n.userRole||"academic_admin"]||"Administrator"),D=u(()=>{const d=c.systemHealthStatus;return{healthy:"Good",warning:"Warning",critical:"Critical",unknown:"Unknown"}[d]||"Unknown"}),U=d=>d.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),j=async()=>{try{await n.logout(),await i.push("/login")}catch(d){console.error("Logout failed:",d)}};return K(async()=>{try{n.hasPermission("system_monitoring")&&await c.refreshSystemMetrics()}catch(d){console.error("Failed to load dashboard data:",d)}}),(d,t)=>{const x=X("router-link");return _(),p("div",le,[e("nav",re,[e("div",oe,[t[3]||(t[3]=e("span",{class:"navbar-brand fw-bold"},"Zeus Academia - Admin",-1)),e("div",ne,[e("div",ie,[e("a",ce,[e("div",de,m(h.value),1),E(" "+m(v(n).userFullName),1)]),e("ul",ue,[e("li",null,[k(x,{class:"dropdown-item",to:"/profile"},{default:C(()=>[...t[0]||(t[0]=[e("i",{class:"bi bi-person-circle me-2"},null,-1),E("Profile ",-1)])]),_:1})]),t[2]||(t[2]=e("li",null,[e("hr",{class:"dropdown-divider"})],-1)),e("li",null,[e("a",{class:"dropdown-item",href:"#",onClick:j},[...t[1]||(t[1]=[e("i",{class:"bi bi-box-arrow-right me-2"},null,-1),E("Logout ",-1)])])])])])])])]),e("div",me,[e("div",ve,[e("div",ge,[e("div",fe,[e("div",be,[e("h1",he," Welcome, "+m(v(n).userFullName),1),e("p",ye,[t[4]||(t[4]=E(" Role: ",-1)),e("span",pe,m(A.value),1),t[5]||(t[5]=E(" Security Level: ",-1)),e("span",{class:Y("badge security-level "+v(n).securityLevel)},m(v(n).securityLevel.toUpperCase()),3)]),e("p",_e," Last Login: "+m(U(new Date)),1)])])])]),e("div",we,[v(n).isSystemAdmin?(_(),p(F,{key:0},[e("div",xe,[e("div",Se,[e("div",ke,[e("div",Ce,[e("div",null,[t[6]||(t[6]=e("h5",{class:"card-title"},"Total Users",-1)),e("h2",Ee,m(y.value.totalUsers||0),1)]),t[7]||(t[7]=e("div",{class:"card-icon"},[e("i",{class:"bi bi-people-fill"})],-1))])])])]),e("div",Ae,[e("div",De,[e("div",Ue,[e("div",je,[e("div",null,[t[8]||(t[8]=e("h5",{class:"card-title"},"System Health",-1)),e("h2",Fe,m(D.value),1)]),t[9]||(t[9]=e("div",{class:"card-icon"},[e("i",{class:"bi bi-heart-pulse-fill"})],-1))])])])]),e("div",Me,[e("div",Le,[e("div",Pe,[e("div",Ne,[e("div",null,[t[10]||(t[10]=e("h5",{class:"card-title"},"Active Sessions",-1)),e("h2",Oe,m(y.value.activeSessions||0),1)]),t[11]||(t[11]=e("div",{class:"card-icon"},[e("i",{class:"bi bi-activity"})],-1))])])])]),e("div",Re,[e("div",Be,[e("div",He,[e("div",ze,[e("div",null,[t[12]||(t[12]=e("h5",{class:"card-title"},"Critical Alerts",-1)),e("h2",Ie,m(y.value.criticalAlerts||0),1)]),t[13]||(t[13]=e("div",{class:"card-icon"},[e("i",{class:"bi bi-exclamation-triangle-fill"})],-1))])])])])],64)):S("",!0),v(n).isRegistrar?(_(),p(F,{key:1},[e("div",Ve,[e("div",Te,[e("div",We,[e("div",$e,[e("div",null,[t[14]||(t[14]=e("h5",{class:"card-title"},"Total Enrollments",-1)),e("h2",Ge,m(b.value.totalEnrollments||0),1)]),t[15]||(t[15]=e("div",{class:"card-icon"},[e("i",{class:"bi bi-journal-bookmark-fill"})],-1))])])])]),e("div",Qe,[e("div",Ze,[e("div",qe,[e("div",Je,[e("div",null,[t[16]||(t[16]=e("h5",{class:"card-title"},"Active Courses",-1)),e("h2",Ke,m(b.value.activeCourses||0),1)]),t[17]||(t[17]=e("div",{class:"card-icon"},[e("i",{class:"bi bi-book-fill"})],-1))])])])])],64)):S("",!0),v(n).isAcademicAdmin?(_(),p(F,{key:2},[e("div",Xe,[e("div",Ye,[e("div",es,[e("div",ss,[e("div",null,[t[18]||(t[18]=e("h5",{class:"card-title"},"Faculty Members",-1)),e("h2",ts,m(b.value.facultyCount||0),1)]),t[19]||(t[19]=e("div",{class:"card-icon"},[e("i",{class:"bi bi-mortarboard-fill"})],-1))])])])]),e("div",as,[e("div",ls,[e("div",rs,[e("div",os,[e("div",null,[t[20]||(t[20]=e("h5",{class:"card-title"},"Departments",-1)),e("h2",ns,m(b.value.departmentCount||0),1)]),t[21]||(t[21]=e("div",{class:"card-icon"},[e("i",{class:"bi bi-building"})],-1))])])])])],64)):S("",!0)]),e("div",is,[e("div",cs,[e("div",ds,[t[28]||(t[28]=e("div",{class:"card-header"},[e("h5",{class:"card-title mb-0"},"Quick Actions")],-1)),e("div",us,[e("div",ms,[v(n).hasPermission("user_management")?(_(),p("div",vs,[k(x,{to:"/users",class:"btn btn-outline-primary w-100 h-100 d-flex flex-column justify-content-center align-items-center py-3"},{default:C(()=>[...t[22]||(t[22]=[e("i",{class:"bi bi-people fs-1 mb-2"},null,-1),e("span",null,"Manage Users",-1)])]),_:1})])):S("",!0),v(n).hasPermission("system_configuration")?(_(),p("div",gs,[k(x,{to:"/system",class:"btn btn-outline-secondary w-100 h-100 d-flex flex-column justify-content-center align-items-center py-3"},{default:C(()=>[...t[23]||(t[23]=[e("i",{class:"bi bi-gear fs-1 mb-2"},null,-1),e("span",null,"System Config",-1)])]),_:1})])):S("",!0),v(n).hasPermission("academic_calendar")?(_(),p("div",fs,[k(x,{to:"/academic",class:"btn btn-outline-success w-100 h-100 d-flex flex-column justify-content-center align-items-center py-3"},{default:C(()=>[...t[24]||(t[24]=[e("i",{class:"bi bi-calendar-event fs-1 mb-2"},null,-1),e("span",null,"Academic",-1)])]),_:1})])):S("",!0),v(n).hasPermission("financial_management")?(_(),p("div",bs,[k(x,{to:"/financial",class:"btn btn-outline-warning w-100 h-100 d-flex flex-column justify-content-center align-items-center py-3"},{default:C(()=>[...t[25]||(t[25]=[e("i",{class:"bi bi-currency-dollar fs-1 mb-2"},null,-1),e("span",null,"Financial",-1)])]),_:1})])):S("",!0),v(n).hasPermission("system_monitoring")?(_(),p("div",hs,[k(x,{to:"/monitoring",class:"btn btn-outline-info w-100 h-100 d-flex flex-column justify-content-center align-items-center py-3"},{default:C(()=>[...t[26]||(t[26]=[e("i",{class:"bi bi-graph-up fs-1 mb-2"},null,-1),e("span",null,"Monitoring",-1)])]),_:1})])):S("",!0),v(n).hasPermission("audit_access")?(_(),p("div",ys,[k(x,{to:"/audit",class:"btn btn-outline-danger w-100 h-100 d-flex flex-column justify-content-center align-items-center py-3"},{default:C(()=>[...t[27]||(t[27]=[e("i",{class:"bi bi-shield-check fs-1 mb-2"},null,-1),e("span",null,"Audit Logs",-1)])]),_:1})])):S("",!0)])])])])])])])}}}),ks=te(ps,[["__scopeId","data-v-626f5a11"]]);export{ks as default};
//# sourceMappingURL=DashboardView-DsSPeBSe.js.map
